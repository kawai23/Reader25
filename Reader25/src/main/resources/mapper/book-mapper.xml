<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="bookMapper">
	
	<select id="selectList" resultMap="bookResultSet">
		select *
		from book
		where status = 'Y'
		order by BOOK_NO desc
	</select>
	
	<resultMap type="Book" id="bookResultSet">
		<id property="b_no" column="BOOK_NO"/>
		<result property="b_name" column="BOOK_NAME"/>
		<result property="b_price" column="PRICE"/>
		<result property="b_Q1" column="BOOK_Q1"/>
		<result property="b_Q2" column="BOOK_Q2"/>
		<result property="b_Q3" column="BOOK_Q3"/>
		<result property="author" column="AUTHOR"/>
		<result property="b_Status" column="STATUS"/>
	</resultMap>
	
	<select id="getPayList" resultType="_int">
		select count(*)
		from pay
		where status = 'N' <!-- 삭제 여부 -->
	</select>
	<select id="selectPayList" resultMap="payResultSet">
		select p.*, book_name
		from pay p
			join book b on(p.book_no = b.book_no)
		where p.status = 'N'
		order by pay_no desc
	</select>
	<resultMap type="Pay" id="payResultSet">
		<id property="pay_no" column="PAY_NO"/>
		<result property="book_name" column="BOOK_NAME"/>
		<result property="book_v" column="BOOK_V"/>
		<result property="price" column="PRICE"/>
		<result property="pay_status" column="PAY_STATUS"/>
		<result property="status" column="STATUS"/>
		<result property="pay_date" column="PAY_DATE"/>
		<result property="userId" column="USER_ID"/>
		<result property="book_no" column="BOOK_NO"/>
	</resultMap>
	
	<select id="selectBookList" resultMap="bookResultSet">
		select *
		from book
		where status = 'Y'
	</select>
	
	<select id="selectBook" resultMap="bookResultSet">
		select *
		from book
		where status = 'Y' and book_no = #{b_no}
	</select>
	<insert id="insertBook">
		insert into book
		values(book_seq.nextval, #{b_name}, #{b_price},#{b_Q1}, #{b_Q2}, null,
			#{author}, default)
	</insert>
</mapper>
